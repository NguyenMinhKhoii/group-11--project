<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>üë§ H·ªì s∆° ng∆∞·ªùi d√πng - RBAC System</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css">
  <link rel="stylesheet" href="style.css">
</head>
<body class="dashboard-page">
  <!-- Navigation -->
  <nav class="navbar navbar-expand-lg navbar-dark bg-primary fixed-top">
    <div class="container">
      <a class="navbar-brand" href="dashboard.html">
        <i class="bi bi-shield-check"></i>
        üîê RBAC System
      </a>
      <div class="navbar-nav ms-auto">
        <span class="navbar-text me-3">
          üë§ <span id="navUserRole">Loading...</span>
        </span>
        <button class="btn btn-outline-light btn-sm" onclick="logout()">
          <i class="bi bi-box-arrow-right"></i> ƒêƒÉng xu·∫•t
        </button>
      </div>
    </div>
  </nav>

  <div class="container mt-4">
    <!-- Header -->
    <div class="row">
      <div class="col-12">
        <div class="d-flex justify-content-between align-items-center mb-4">
          <div>
            <h2 class="text-primary">
              <i class="bi bi-person-circle"></i> üë§ H·ªì s∆° ng∆∞·ªùi d√πng
            </h2>
            <p class="text-muted">Xem v√† ch·ªânh s·ª≠a th√¥ng tin c√° nh√¢n</p>
          </div>
          <a href="dashboard.html" class="btn btn-secondary">
            <i class="bi bi-arrow-left"></i> üîô Quay l·∫°i Dashboard
          </a>
        </div>
      </div>
    </div>

    <!-- Profile Content -->
    <div class="row g-4">
      <!-- Profile Info Card -->
      <div class="col-xl-4 col-lg-5">
        <div class="card card-success">
          <div class="card-body text-center">
            <div class="profile-avatar mb-4">
              <img id="profileAvatar" src="https://via.placeholder.com/200/cccccc/666666?text=Avatar" 
                   alt="Avatar" class="rounded-circle" width="200" height="200">
            </div>
            <h4 id="profileName" class="card-title mb-2">Loading...</h4>
            <p id="profileEmail" class="text-muted fs-5 mb-3">Loading...</p>
            <div class="badge-container">
              <span id="profileRoleBadge" class="badge bg-primary fs-6">USER</span>
            </div>
            
            <div class="profile-stats">
              <div class="row text-center">
                <div class="col-4">
                  <div class="stat-item">
                    <h4 class="mb-1">üìÖ</h4>
                    <h6 class="mb-0">30 ng√†y</h6>
                    <small>Tham gia</small>
                  </div>
                </div>
                <div class="col-4">
                  <div class="stat-item">
                    <h4 class="mb-1">üéØ</h4>
                    <h6 class="mb-0">127</h6>
                    <small>Ho·∫°t ƒë·ªông</small>
                  </div>
                </div>
                <div class="col-4">
                  <div class="stat-item">
                    <h4 class="mb-1">‚≠ê</h4>
                    <h6 class="mb-0">4.8</h6>
                    <small>ƒê√°nh gi√°</small>
                  </div>
                </div>
              </div>
            </div>
            
            <div class="mt-4 d-grid gap-2">
              <button class="btn btn-primary btn-custom" onclick="window.location.href='upload-avatar.html'">
                <i class="bi bi-camera"></i> üì∑ ƒê·ªïi Avatar
              </button>
              <button class="btn btn-success btn-custom" onclick="window.location.href='dashboard.html'">
                <i class="bi bi-speedometer2"></i> üìä Dashboard
              </button>
            </div>
          </div>
        </div>

        <!-- Quick Actions Card -->
        <div class="card mt-4">
          <div class="card-header">
            <h6 class="mb-0"><i class="bi bi-lightning"></i> ‚ö° Thao t√°c nhanh</h6>
          </div>
          <div class="card-body">
            <div class="d-grid gap-2">
              <button class="btn btn-outline-primary btn-sm" onclick="document.getElementById('edit-tab').click()">
                <i class="bi bi-pencil"></i> ‚úèÔ∏è Ch·ªânh s·ª≠a h·ªì s∆°
              </button>
              <button class="btn btn-outline-warning btn-sm" onclick="document.getElementById('password-tab').click()">
                <i class="bi bi-key"></i> üîë ƒê·ªïi m·∫≠t kh·∫©u
              </button>
              <button class="btn btn-outline-info btn-sm" onclick="window.location.href='upload-avatar.html'">
                <i class="bi bi-image"></i> üñºÔ∏è Qu·∫£n l√Ω ·∫£nh
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- Profile Details & Edit -->
      <div class="col-xl-8 col-lg-7">
        <div class="card">
          <div class="card-header">
            <ul class="nav nav-tabs card-header-tabs" id="profileTabs">
              <li class="nav-item">
                <a class="nav-link active" id="info-tab" data-bs-toggle="tab" href="#info" role="tab">
                  <i class="bi bi-info-circle"></i> üìã Th√¥ng tin chi ti·∫øt
                </a>
              </li>
              <li class="nav-item">
                <a class="nav-link" id="edit-tab" data-bs-toggle="tab" href="#edit" role="tab">
                  <i class="bi bi-pencil"></i> ‚úèÔ∏è Ch·ªânh s·ª≠a h·ªì s∆°
                </a>
              </li>
              <li class="nav-item">
                <a class="nav-link" id="password-tab" data-bs-toggle="tab" href="#password" role="tab">
                  <i class="bi bi-key"></i> üîë B·∫£o m·∫≠t & M·∫≠t kh·∫©u
                </a>
              </li>
            </ul>
          </div>
          <div class="card-body">
            <div class="tab-content">
              <!-- Info Tab -->
              <div class="tab-pane fade show active" id="info" role="tabpanel">
                <div class="d-flex justify-content-between align-items-center mb-4">
                  <h5 class="mb-0">üìã Th√¥ng tin chi ti·∫øt</h5>
                  <button class="btn btn-outline-primary btn-sm" onclick="document.getElementById('edit-tab').click()">
                    <i class="bi bi-pencil"></i> Ch·ªânh s·ª≠a
                  </button>
                </div>
                
                <div class="row g-4">
                  <div class="col-lg-6">
                    <h6 class="text-primary mb-3">üë§ Th√¥ng tin c∆° b·∫£n</h6>
                    <div class="info-item">
                      <label>üìß ƒê·ªãa ch·ªâ Email</label>
                      <p id="infoEmail">Loading...</p>
                    </div>
                    <div class="info-item">
                      <label>üë§ H·ªç v√† t√™n</label>
                      <p id="infoFullname">Loading...</p>
                    </div>
                    <div class="info-item">
                      <label>üé≠ Vai tr√≤ trong h·ªá th·ªëng</label>
                      <p id="infoRole">Loading...</p>
                    </div>
                  </div>
                  <div class="col-lg-6">
                    <h6 class="text-primary mb-3">üìû Th√¥ng tin li√™n h·ªá</h6>
                    <div class="info-item">
                      <label>üì± S·ªë ƒëi·ªán tho·∫°i</label>
                      <p id="infoPhone">Ch∆∞a c·∫≠p nh·∫≠t</p>
                    </div>
                    <div class="info-item">
                      <label>üìç ƒê·ªãa ch·ªâ</label>
                      <p id="infoAddress">Ch∆∞a c·∫≠p nh·∫≠t</p>
                    </div>
                    <div class="info-item">
                      <label>üìù Gi·ªõi thi·ªáu b·∫£n th√¢n</label>
                      <p id="infoBio">Ch∆∞a c·∫≠p nh·∫≠t</p>
                    </div>
                  </div>
                </div>

                <!-- Activity Summary -->
                <hr class="my-4">
                <div class="row text-center">
                  <div class="col-md-3">
                    <div class="activity-stat">
                      <h4 class="text-primary mb-1">üîê</h4>
                      <h5 class="mb-1">15</h5>
                      <small class="text-muted">L·∫ßn ƒëƒÉng nh·∫≠p</small>
                    </div>
                  </div>
                  <div class="col-md-3">
                    <div class="activity-stat">
                      <h4 class="text-success mb-1">üìä</h4>
                      <h5 class="mb-1">42</h5>
                      <small class="text-muted">Ho·∫°t ƒë·ªông</small>
                    </div>
                  </div>
                  <div class="col-md-3">
                    <div class="activity-stat">
                      <h4 class="text-warning mb-1">üïí</h4>
                      <h5 class="mb-1">2h 30m</h5>
                      <small class="text-muted">Th·ªùi gian online</small>
                    </div>
                  </div>
                  <div class="col-md-3">
                    <div class="activity-stat">
                      <h4 class="text-info mb-1">üìÖ</h4>
                      <h5 class="mb-1">30 ng√†y</h5>
                      <small class="text-muted">Th√†nh vi√™n</small>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Edit Tab -->
              <div class="tab-pane fade" id="edit" role="tabpanel">
                <div class="d-flex justify-content-between align-items-center mb-4">
                  <h5 class="mb-0">‚úèÔ∏è Ch·ªânh s·ª≠a th√¥ng tin h·ªì s∆°</h5>
                  <button type="button" class="btn btn-outline-secondary btn-sm" onclick="document.getElementById('info-tab').click()">
                    <i class="bi bi-arrow-left"></i> Quay l·∫°i
                  </button>
                </div>
                
                <form id="editProfileForm">
                  <div class="row g-4">
                    <div class="col-lg-6">
                      <div class="card border-0 bg-light">
                        <div class="card-header bg-primary text-white">
                          <h6 class="mb-0">üë§ Th√¥ng tin c√° nh√¢n</h6>
                        </div>
                        <div class="card-body">
                          <div class="mb-4">
                            <label class="form-label fw-bold">üë§ H·ªç v√† t√™n ƒë·∫ßy ƒë·ªß *</label>
                            <input type="text" class="form-control form-control-lg" id="editFullname" required 
                                   placeholder="Nh·∫≠p h·ªç t√™n ƒë·∫ßy ƒë·ªß c·ªßa b·∫°n">
                            <div class="form-text">T√™n n√†y s·∫Ω hi·ªÉn th·ªã c√¥ng khai trong h·ªá th·ªëng</div>
                          </div>
                          <div class="mb-3">
                            <label class="form-label fw-bold">ÔøΩ Gi·ªõi thi·ªáu b·∫£n th√¢n</label>
                            <textarea class="form-control" id="editBio" rows="4" 
                                      placeholder="Vi·∫øt v√†i d√≤ng gi·ªõi thi·ªáu v·ªÅ b·∫£n th√¢n, s·ªü th√≠ch, kinh nghi·ªám..."></textarea>
                            <div class="form-text">T·ªëi ƒëa 500 k√Ω t·ª±</div>
                          </div>
                        </div>
                      </div>
                    </div>
                    
                    <div class="col-lg-6">
                      <div class="card border-0 bg-light">
                        <div class="card-header bg-success text-white">
                          <h6 class="mb-0">üìû Th√¥ng tin li√™n h·ªá</h6>
                        </div>
                        <div class="card-body">
                          <div class="mb-4">
                            <label class="form-label fw-bold">ÔøΩ S·ªë ƒëi·ªán tho·∫°i</label>
                            <input type="tel" class="form-control form-control-lg" id="editPhone" 
                                   placeholder="V√≠ d·ª•: 0901234567">
                            <div class="form-text">S·ªë ƒëi·ªán tho·∫°i ƒë·ªÉ li√™n h·ªá khi c·∫ßn thi·∫øt</div>
                          </div>
                          <div class="mb-3">
                            <label class="form-label fw-bold">ÔøΩ ƒê·ªãa ch·ªâ</label>
                            <input type="text" class="form-control form-control-lg" id="editAddress" 
                                   placeholder="V√≠ d·ª•: Qu·∫≠n 1, TP.HCM">
                            <div class="form-text">ƒê·ªãa ch·ªâ hi·ªán t·∫°i c·ªßa b·∫°n</div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  
                  <div class="row mt-4">
                    <div class="col-12">
                      <div class="d-flex justify-content-end gap-3">
                        <button type="button" class="btn btn-secondary btn-lg" onclick="document.getElementById('info-tab').click()">
                          <i class="bi bi-x-circle"></i> H·ªßy b·ªè
                        </button>
                        <button type="submit" class="btn btn-success btn-lg">
                          <i class="bi bi-check-circle"></i> ‚úÖ L∆∞u thay ƒë·ªïi
                        </button>
                      </div>
                    </div>
                  </div>
                </form>
              </div>

              <!-- Password Tab -->
              <div class="tab-pane fade" id="password" role="tabpanel">
                <div class="d-flex justify-content-between align-items-center mb-4">
                  <h5 class="mb-0">üîë B·∫£o m·∫≠t & ƒê·ªïi m·∫≠t kh·∫©u</h5>
                  <button type="button" class="btn btn-outline-secondary btn-sm" onclick="document.getElementById('info-tab').click()">
                    <i class="bi bi-arrow-left"></i> Quay l·∫°i
                  </button>
                </div>
                
                <div class="row g-4">
                  <div class="col-lg-8">
                    <div class="card border-0 bg-light">
                      <div class="card-header bg-warning text-dark">
                        <h6 class="mb-0">üîí Thay ƒë·ªïi m·∫≠t kh·∫©u</h6>
                      </div>
                      <div class="card-body">
                        <form id="changePasswordForm">
                          <div class="mb-4">
                            <label class="form-label fw-bold">üîí M·∫≠t kh·∫©u hi·ªán t·∫°i *</label>
                            <input type="password" class="form-control form-control-lg" id="currentPassword" required 
                                   placeholder="Nh·∫≠p m·∫≠t kh·∫©u ƒëang s·ª≠ d·ª•ng">
                            <div class="form-text">ƒê·ªÉ x√°c minh danh t√≠nh c·ªßa b·∫°n</div>
                          </div>
                          <div class="mb-4">
                            <label class="form-label fw-bold">üÜï M·∫≠t kh·∫©u m·ªõi *</label>
                            <input type="password" class="form-control form-control-lg" id="newPassword" required minlength="6"
                                   placeholder="Nh·∫≠p m·∫≠t kh·∫©u m·ªõi (t·ªëi thi·ªÉu 6 k√Ω t·ª±)">
                            <div class="form-text">M·∫≠t kh·∫©u m·ªõi ph·∫£i kh√°c m·∫≠t kh·∫©u hi·ªán t·∫°i</div>
                          </div>
                          <div class="mb-4">
                            <label class="form-label fw-bold">üîÅ X√°c nh·∫≠n m·∫≠t kh·∫©u m·ªõi *</label>
                            <input type="password" class="form-control form-control-lg" id="confirmPassword" required
                                   placeholder="Nh·∫≠p l·∫°i m·∫≠t kh·∫©u m·ªõi ƒë·ªÉ x√°c nh·∫≠n">
                            <div class="form-text">Ph·∫£i tr√πng kh·ªõp v·ªõi m·∫≠t kh·∫©u m·ªõi ·ªü tr√™n</div>
                          </div>
                          
                          <div class="d-flex justify-content-end gap-3 mt-4">
                            <button type="button" class="btn btn-secondary btn-lg" onclick="document.getElementById('changePasswordForm').reset()">
                              <i class="bi bi-arrow-clockwise"></i> L√†m m·ªõi
                            </button>
                            <button type="submit" class="btn btn-warning btn-lg">
                              <i class="bi bi-key"></i> üîë ƒê·ªïi m·∫≠t kh·∫©u
                            </button>
                          </div>
                        </form>
                      </div>
                    </div>
                  </div>
                  
                  <div class="col-lg-4">
                    <div class="card border-0">
                      <div class="card-header bg-info text-white">
                        <h6 class="mb-0">üí° H∆∞·ªõng d·∫´n b·∫£o m·∫≠t</h6>
                      </div>
                      <div class="card-body">
                        <div class="security-tips">
                          <div class="tip-item mb-3">
                            <h6 class="text-success">‚úÖ M·∫≠t kh·∫©u m·∫°nh c·∫ßn c√≥:</h6>
                            <ul class="small">
                              <li>T·ªëi thi·ªÉu 8 k√Ω t·ª±</li>
                              <li>Ch·ªØ hoa (A-Z)</li>
                              <li>Ch·ªØ th∆∞·ªùng (a-z)</li>
                              <li>S·ªë (0-9)</li>
                              <li>K√Ω t·ª± ƒë·∫∑c bi·ªát (!@#$%)</li>
                            </ul>
                          </div>
                          
                          <div class="tip-item mb-3">
                            <h6 class="text-danger">‚ùå Tr√°nh s·ª≠ d·ª•ng:</h6>
                            <ul class="small">
                              <li>Th√¥ng tin c√° nh√¢n (t√™n, ng√†y sinh)</li>
                              <li>T·ª´ ƒëi·ªÉn th√¥ng th∆∞·ªùng</li>
                              <li>Chu·ªói k√Ω t·ª± li√™n ti·∫øp (123456)</li>
                              <li>M·∫≠t kh·∫©u ƒë√£ d√πng tr∆∞·ªõc ƒë√¢y</li>
                            </ul>
                          </div>
                          
                          <div class="alert alert-warning small">
                            <i class="bi bi-exclamation-triangle"></i>
                            <strong>L∆∞u √Ω:</strong> Kh√¥ng chia s·∫ª m·∫≠t kh·∫©u v·ªõi b·∫•t k·ª≥ ai v√† thay ƒë·ªïi ƒë·ªãnh k·ª≥ m·ªói 3-6 th√°ng.
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
  
  <script>
    const API_BASE_URL = 'http://localhost:5173/api/auth';
    
    // Load profile on page load
    window.addEventListener('load', () => {
        loadProfile();
        
        // Check if we need to show password tab directly
        if (window.location.hash === '#password') {
            document.getElementById('password-tab').click();
        }
    });

    function loadProfile() {
        const user = JSON.parse(localStorage.getItem('user') || '{}');
        
        if (!user.email) {
            alert('‚ùå Vui l√≤ng ƒëƒÉng nh·∫≠p ƒë·ªÉ xem h·ªì s∆°!');
            window.location.href = 'login.html';
            return;
        }

        // Display user info in navbar
        const roleText = user.role === 'admin' ? 'Admin (admin)' : 
                        user.role === 'moderator' ? 'Moderator (moderator)' : 
                        'Regular User (user)';
        document.getElementById('navUserRole').textContent = roleText;

        // Load profile data from server
        fetchProfileData(user.email);
    }

    async function fetchProfileData(email) {
        try {
            const response = await fetch(`${API_BASE_URL}/profile/${encodeURIComponent(email)}`);
            const data = await response.json();

            if (data.success) {
                displayProfileData(data.user);
            } else {
                // Fallback to localStorage data
                const user = JSON.parse(localStorage.getItem('user') || '{}');
                displayProfileData(user);
            }
        } catch (error) {
            console.error('Error fetching profile:', error);
            // Fallback to localStorage data
            const user = JSON.parse(localStorage.getItem('user') || '{}');
            displayProfileData(user);
        }
    }

    function displayProfileData(user) {
        console.log('üîÑ Displaying profile data:', user);
        
        // Profile card - Handle avatar with fallback
        const avatarElement = document.getElementById('profileAvatar');
        const avatarUrl = user.avatar || `https://via.placeholder.com/200/667eea/white?text=${encodeURIComponent(user.fullname || 'User')}`;
        
        console.log('üñºÔ∏è Setting avatar URL:', avatarUrl);
        avatarElement.src = avatarUrl;
        
        // Add error handler for avatar loading
        avatarElement.onerror = function() {
            console.log('‚ùå Avatar load failed, using fallback');
            this.src = `https://via.placeholder.com/200/cccccc/666666?text=${encodeURIComponent(user.fullname || 'Avatar')}`;
            this.onerror = null; // Prevent infinite loop
        };
        
        // Ensure avatar loads properly
        avatarElement.onload = function() {
            console.log('‚úÖ Avatar loaded successfully');
        };
        
        document.getElementById('profileName').textContent = user.fullname || 'Unknown User';
        document.getElementById('profileEmail').textContent = user.email || '';
        
        // Role badge
        const roleBadge = document.getElementById('profileRoleBadge');
        const roleMap = {
            admin: { text: 'ADMIN', class: 'bg-danger' },
            moderator: { text: 'MODERATOR', class: 'bg-warning' },
            user: { text: 'USER', class: 'bg-primary' }
        };
        const roleInfo = roleMap[user.role] || roleMap.user;
        roleBadge.textContent = roleInfo.text;
        roleBadge.className = `badge ${roleInfo.class}`;

        // Info tab
        document.getElementById('infoEmail').textContent = user.email || '';
        document.getElementById('infoFullname').textContent = user.fullname || 'Ch∆∞a c·∫≠p nh·∫≠t';
        document.getElementById('infoRole').textContent = (user.role || 'user').toUpperCase();
        document.getElementById('infoPhone').textContent = user.phone || 'Ch∆∞a c·∫≠p nh·∫≠t';
        document.getElementById('infoAddress').textContent = user.address || 'Ch∆∞a c·∫≠p nh·∫≠t';
        document.getElementById('infoBio').textContent = user.bio || 'Ch∆∞a c·∫≠p nh·∫≠t';

        // Edit form
        document.getElementById('editFullname').value = user.fullname || '';
        document.getElementById('editPhone').value = user.phone || '';
        document.getElementById('editAddress').value = user.address || '';
        document.getElementById('editBio').value = user.bio || '';
    }

    // Edit profile form handler
    document.getElementById('editProfileForm').addEventListener('submit', async (e) => {
        e.preventDefault();
        
        const user = JSON.parse(localStorage.getItem('user') || '{}');
        const formData = {
            fullname: document.getElementById('editFullname').value,
            phone: document.getElementById('editPhone').value,
            address: document.getElementById('editAddress').value,
            bio: document.getElementById('editBio').value
        };

        try {
            const response = await fetch(`${API_BASE_URL}/profile/${encodeURIComponent(user.email)}`, {
                method: 'PUT',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(formData)
            });

            const data = await response.json();

            if (data.success) {
                alert('‚úÖ ' + data.message);
                // Update localStorage
                const updatedUser = { ...user, ...data.user };
                localStorage.setItem('user', JSON.stringify(updatedUser));
                // Refresh display
                displayProfileData(updatedUser);
                // Switch back to info tab
                document.getElementById('info-tab').click();
            } else {
                alert('‚ùå ' + data.message);
            }
        } catch (error) {
            console.error('Error updating profile:', error);
            alert('‚ùå L·ªói k·∫øt n·ªëi server!');
        }
    });

    // Change password form handler
    document.getElementById('changePasswordForm').addEventListener('submit', async (e) => {
        e.preventDefault();
        
        const currentPassword = document.getElementById('currentPassword').value;
        const newPassword = document.getElementById('newPassword').value;
        const confirmPassword = document.getElementById('confirmPassword').value;

        // Validate passwords match
        if (newPassword !== confirmPassword) {
            alert('‚ùå M·∫≠t kh·∫©u x√°c nh·∫≠n kh√¥ng kh·ªõp!');
            return;
        }

        const user = JSON.parse(localStorage.getItem('user') || '{}');

        try {
            const response = await fetch(`${API_BASE_URL}/users/${encodeURIComponent(user.email)}/password`, {
                method: 'PUT',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    currentPassword,
                    newPassword
                })
            });

            const data = await response.json();

            if (data.success) {
                alert('‚úÖ ' + data.message);
                // Clear form
                document.getElementById('changePasswordForm').reset();
                // Switch back to info tab
                document.getElementById('info-tab').click();
            } else {
                alert('‚ùå ' + data.message);
            }
        } catch (error) {
            console.error('Error changing password:', error);
            alert('‚ùå L·ªói k·∫øt n·ªëi server!');
        }
    });

    function logout() {
        if (confirm('B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën ƒëƒÉng xu·∫•t?')) {
            localStorage.removeItem('user');
      localStorage.removeItem('token');
      localStorage.removeItem('authToken');
            alert('üëã ƒê√£ ƒëƒÉng xu·∫•t!');
            window.location.href = 'login.html';
        }
    }
  </script>

  <style>
    /* Desktop-optimized styles */
    .container {
      max-width: 1400px;
    }

    .profile-avatar img {
      border: 4px solid #fff;
      box-shadow: 0 8px 16px rgba(0,0,0,0.15);
      transition: transform 0.3s ease;
    }

    .profile-avatar img:hover {
      transform: scale(1.05);
    }

    .info-item {
      margin-bottom: 1.5rem;
      padding: 1rem;
      background: #f8f9fa;
      border-radius: 8px;
      transition: background 0.2s ease;
    }

    .info-item:hover {
      background: #e9ecef;
    }

    .info-item label {
      font-size: 1rem;
      font-weight: 600;
      color: #495057;
      margin-bottom: 0.5rem;
      display: block;
    }

    .info-item p {
      margin-bottom: 0;
      font-size: 1.1rem;
      color: #212529;
      font-weight: 500;
    }

    .card-success {
      border-left: 6px solid #28a745;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }

    .card {
      box-shadow: 0 6px 20px rgba(0,0,0,0.1);
      border: none;
      border-radius: 12px;
    }

    .card-header {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border-radius: 12px 12px 0 0 !important;
    }

    .nav-tabs .nav-link {
      color: rgba(255,255,255,0.8);
      border: none;
      font-weight: 500;
      font-size: 1rem;
      padding: 1rem 1.5rem;
    }

    .nav-tabs .nav-link.active {
      background: rgba(255,255,255,0.2);
      color: white;
      border-radius: 8px 8px 0 0;
    }

    .nav-tabs .nav-link:hover {
      background: rgba(255,255,255,0.1);
      color: white;
    }

    .profile-stats {
      margin: 1.5rem 0;
      padding: 1rem;
      background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
      border-radius: 12px;
      color: white;
    }

    .badge-container {
      margin: 1.5rem 0;
    }

    .badge {
      font-size: 0.9rem;
      padding: 0.7rem 1.2rem;
      border-radius: 20px;
    }

    .form-control {
      padding: 0.8rem 1rem;
      font-size: 1rem;
      border-radius: 8px;
      border: 2px solid #e9ecef;
      transition: all 0.3s ease;
    }

    .form-control:focus {
      border-color: #667eea;
      box-shadow: 0 0 0 0.2rem rgba(102, 126, 234, 0.25);
    }

    .btn-custom {
      padding: 0.8rem 2rem;
      font-size: 1rem;
      font-weight: 600;
      border-radius: 25px;
      transition: all 0.3s ease;
      margin: 0.3rem;
      min-width: 150px;
    }

    .btn-custom:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(0,0,0,0.15);
    }

    .tab-content {
      padding: 2rem;
    }

    .alert {
      border-radius: 12px;
      border: none;
      padding: 1.5rem;
    }

    /* Desktop spacing improvements */
    h2 {
      font-size: 2rem;
      font-weight: 600;
    }

    h5 {
      font-size: 1.4rem;
      font-weight: 600;
      margin-bottom: 2rem;
    }

    .row {
      margin-bottom: 1rem;
    }

    /* Navbar enhancements */
    .navbar {
      padding: 1rem 0;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }

    .navbar-brand {
      font-size: 1.3rem;
      font-weight: 700;
    }

    /* Profile card enhancements */
    .text-center img {
      transition: all 0.3s ease;
    }

    .card-body {
      padding: 2rem;
    }

    /* Desktop-specific layouts */
    @media (min-width: 1200px) {
      .col-md-4 {
        position: sticky;
        top: 2rem;
        height: fit-content;
      }
      
      .container {
        padding: 0 3rem;
      }
    }

    /* Enhanced buttons */
    .btn-success { background: linear-gradient(135deg, #28a745, #20c997); border: none; }
    .btn-warning { background: linear-gradient(135deg, #ffc107, #fd7e14); border: none; }
    .btn-info { background: linear-gradient(135deg, #17a2b8, #6f42c1); border: none; }
    .btn-primary { background: linear-gradient(135deg, #007bff, #6610f2); border: none; }
    .btn-danger { background: linear-gradient(135deg, #dc3545, #e83e8c); border: none; }
    .btn-secondary { background: linear-gradient(135deg, #6c757d, #495057); border: none; }
  </style>
</body>
</html>